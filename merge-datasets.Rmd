---
title: "dataset-malware-analysis"
author: "anonymous"
date: '2022-10-14'
output: html_document
description: This script create our final dataset file for analysis - final-ds.csv
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=5, fig.height=5, fig.path='./figures/', dev=c('png', 'pdf'))

setwd(".")

library(sqldf)
library(xtable)
```


```{r vt}

#Load the Datasets
apps <- read.csv("appsHash.csv", head=T, sep=',')

repackaged <- sqldf("select * from apps where app like 'malicious%'")

nrow(repackaged)

avclass <- read.csv("avclass.csv", head=T, sep=',')

nrow(avclass)

avclass <- sqldf("select * 
                  from avclass 
                  where family != 'noIdentify' and family not like 'SINGLETON%'")

nrow(avclass)


s1 <- sqldf("select r.app, r.hash, a.family as family, 'True' as Malware
				from repackaged r, avclass a where r.hash = a.sha256")
						 

s2 <- sqldf("select r.app, r.hash, 'None' as family, 'False' as Malware
                   from repackaged r
                   where r.hash not in (select a.sha256 from avclass a)")

nrow(s1)

nrow(s2)

ds <- rbind(s1, s2)



masResults <- read.csv("summarySimiDroid.csv", head=T)

final_ds <- sqldf("select substring(ds.app,11) as app, ds.hash as hash, ds.family as family, ds.Malware as malware from ds")

colnames(final_ds)
head(final_ds)


 write.csv(final_ds, "final-ds.csv", sep=',', quote = F, row.names = F)
```




